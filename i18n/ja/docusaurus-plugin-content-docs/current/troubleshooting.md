---
title: トラブルシューティングとFAQ
sidebar_label: トラブルシューティング
sidebar_position: 3
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# トラブルシューティングとFAQ

このページでは、GameSentenceMiner（GSM）の使用中に遭遇する頻繁な質問と一般的な問題について説明します。

## 一般的なトラブルシューティング

特定の問題に入る前に、まずこれらの一般的な解決策を試してみてください。多くの問題は、簡単な再起動や環境のリフレッシュで解決できます。

<Tabs>
<TabItem value="restart" label="GSMの再起動" default>

特に接続（OBS、Anki）やUI要素が表示されないなど、多くの一時的な問題は、GSMを完全に再起動することで解決できます。

1.  システムトレイにあるGSMのつるはしアイコンを右クリックします。
2.  **終了**を選択します。
3.  GSMを再起動します。

トレイアイコンが見つからない場合は、タスクマネージャーで`GameSentenceMiner.exe`と`python.exe`のプロセスを終了させる必要があるかもしれません。

</TabItem>
<TabItem value="repair" label="Python環境の修復">

アップデート後にGSMが起動しない場合や、不足しているモジュール（`psutil`、`torchaudio`、`PIL`、`pysbd`）に関するエラーが発生した場合、Python環境が破損している可能性があります。

1.  GSMを完全に終了します。
2.  Windows PowerShellまたはコマンドプロンプトを開きます。
3.  次のコマンドを1つずつ実行します：

    ```powershell
    # このコマンドはパッケージキャッシュをクリーンアップし、いくつかのアップデート問題を解決できます。
    ~/AppData/Roaming/GameSentenceMiner/python/python.exe -m uv cache clean

    # このコマンドはGSM Pythonパッケージの最新バージョンへの強制アップグレードを行います。
    ~/AppData/Roaming/GameSentenceMiner/python/python.exe -m uv pip install --upgrade gamesentenceminer
    ```

4.  GSMを再起動します。最も深刻な場合には、`~/AppData/Roaming/GameSentenceMiner/`内の`python`フォルダを削除し、次回の起動時にGSMに再インストールさせる必要があるかもしれません。

</TabItem>
</Tabs>

## インストールと起動

### GSMがクラッシュするか、起動時に初期化に失敗する

これは、破損したアップデートや他のソフトウェアとの競合が原因であることが多いです。

-   **Razerソフトウェアの競合**: Razer Synapse / Cortexは、GSMもデフォルトで使用するポート`55000`を使用することが知られています。これにより、GSMのWebサーバーが起動せず、ハングアップまたは失敗する原因となります。
    -   **解決策1（推奨）:** GSMのポートを変更します。`設定` -> `一般`に移動し、`Webサーバーポート`を別の番号（例: `55010`）に変更します。
    -   **解決策2:** GSMを開始する前に、すべてのRazerソフトウェアを終了します。
-   **破損したアップデート**: `module 'psutil' has no attribute 'NoSuchProcess'`や`cannot import name 'Image' from 'PIL'`のようなエラーが表示されることがあります。
    -   **解決策**: 上記の**Python環境の修復**の手順に従ってください。

### GSMのインストール場所が見つからない。C:ドライブにしかインストールされない。

現在、GSMのインストールパスはカスタマイズできません。ユーザーデータ、OBS、およびPythonパッケージは`%AppData%\GameSentenceMiner`に保存されます。

## OBSとメディア（音声/スクリーンショット）

### OBSでゲーム画面が真っ黒に表示される

これは一般的なOBSの問題で、特に積極的なアンチチートを持つゲームや排他的フルスクリーンで実行されるゲームで発生します。詳細なリストは[こちら](https://obsproject.com/kb/game-capture-troubleshooting)を参照してください。

-   **管理者として実行**: 多くのゲーム（特に原神のようなHoyoverseのタイトル）は、キャプチャするためにOBSを管理者権限で実行する必要があります。これを行う最も簡単な方法は、GSM自体を管理者として実行することです。
-   **キャプチャ方法の変更**: OBSウィンドウで、ゲームソースをダブルクリックします。`キャプチャ方法`を`自動`から`Windows 10 (1903 and up)`に変更します。
-   **ゲームキャプチャを使用**: ウィンドウキャプチャが失敗した場合は、代わりに「ゲームキャプチャ」ソースで新しいシーンを作成してみてください。
-   **ソースの表示/非表示を切り替える**: OBSでソースの横にある「目」のアイコンをクリックして非表示にしてから再度表示するだけで、黒い画面が修正されることがあります。

### Ankiカードに音声やスクリーンショットがない

これは通常、GSMがOBSと通信できないか、リプレイバッファが正しく機能していないことを意味します。

-   **「リプレイバッファがアクティブではありません」エラー**: これが最も一般的な原因です。
    1.  OBSウィンドウを確認します。「リプレイバッファを開始」ボタンが青色で「リプレイバッファを停止」と表示されているはずです。そうでない場合は、クリックしてください。
    2.  GSMには**自動リプレイバッファ管理**が含まれています。OBSで黒以外の画像が検出されたときにバッファを開始し、非アクティブ期間の後に停止するはずです。これが失敗した場合、通常はGSMの再起動で修正されます。
-   **OBSが切断された**: GSMのホームページのステータスインジケーターを確認します。OBSが切断されている場合は、GSMの`設定 -> OBS`のポートとパスワードが、OBSの`ツール -> WebSocketサーバー設定`の設定と一致していることを確認してください。一般的な問題は、別のプログラムがデフォルトのOBSポート（`7274`）を使用していることです。GSMとOBSの両方で別の番号に変更してみてください。

### カードの音声が間違っている（BGMのみ、間違ったセリフなど）

これはしばしば音声区間検出（VAD）の問題で、モデルが背景音楽やノイズから音声を区別するのに苦労しています。

-   **Whisperの幻覚**: 特にボーカル付きの音楽や無音のゲームセリフがある場合、Whisperは音声がない場所で音声を「幻覚」として検出することがあります。
    -   **解決策**: `設定` -> `VAD / 音声`に移動し、**VADプレフィルターを使用**を有効にします。これにより、Whisperに送信する前に音声を処理してノイズを除去し、精度を大幅に向上させることができますが、非常に高音の声を時々カットすることがあります。
-   **音声が途切れる（開始/終了）**:
    -   **解決策**: `設定 -> キー設定 / 音声`で**開始オフセット**と**終了オフセット**を調整します。開始オフセットに小さな負の値（例: `-0.5`）を設定すると、セリフの開始をキャプチャするのに役立ちます。
-   **二重音声 / エコー**: これは、OBSが特定のゲームの音声と一般的な「デスクトップ音声」の両方をキャプチャしている場合に発生します。
    -   **解決策**: OBSウィンドウの「音声ミキサー」パネルで、「デスクトップ音声」トラックをミュートします。

## OCR（テキスト認識）

### OCRが機能しない、または開始に失敗する

-   **「認識されない引数」エラー**: これは、GSMデスクトップアプリのバージョンとPythonパッケージのバージョンが同期していない場合に発生します。
    -   **解決策**: `ファイル -> GSMを更新`メニューからGSMを更新します。これにより、両方のコンポーネントが互換性のあるバージョンになります。
-   **`oneocr`ファイルが見つからない**: OneOCRは、追加のモデルファイルをダウンロードする必要があります。
    -   **解決策**: `OCR`タブで、**OWOCR依存関係のインストール/更新**ボタンをクリックします。これが失敗した場合は、手動でファイルをダウンロードし、`C:/Users/your_username/.config/oneocr`に配置する必要があるかもしれません。
-   **エリア選択が機能しない**:
    -   **問題**: 「エリアセレクターを実行」を使用すると、画面オーバーレイが表示されますが、保存できないか、すぐに失敗します。
    -   **解決策**: OCRタブで誤ったOBSシーンまたはOBSシーンが選択されていないことが原因である可能性があります。セレクターを実行する前に、正しいシーンが選択されていることを確認してください。

### OCRが不正確または不完全なテキストを返す

-   **テキストがゆっくり表示される**: テキストがフェードインまたはスクロールインする場合、OCRは完全な行が表示される前にスキャンする可能性があります。
    -   **解決策**: `設定 -> OCR -> 追加とデバッグ`で、**スキャン遅延**を増やします。`1.0`（1秒）の値は、多くの場合、良い出発点です。
-   **ふりがなが読み取られる**:
    -   **解決策**: `OCR`タブの**ふりがなフィルター感度**スライダーを使用します。値が高いほど、メインラインの上の小さなテキストをより積極的に削除します。この変更を有効にするには、OCRプロセスを再起動する必要があります。
-   **テキストが分割または複製される**: これは、ピクセル化されたテキスト（DSゲームなど）や高速なスキャンレートでよく発生します。
    -   **解決策**: **OCRスキャンレート**をより高い数値（例: `0.8`または`1.0`）に増やして、画面が安定する時間を長くしてみてください。**2回目のスキャンを最適化**を無効にすると、パフォーマンスが低下する代わりに役立つこともあります。

## オーバーレイ

### オーバーレイが表示されない、または更新されない

-   **デフォルトでは自動ではない**: オーバーレイのOCRスキャンは、Agent、Textractor、またはGSM独自のOCRなどのソースからの新しいテキストイベントによってトリガーされます。**定期的キャプチャ**を有効にしない限り、常時スキャンは行いません。
    -   **解決策**: テキストフックのないメディア（マンガやビデオなど）の場合、`オーバーレイ`設定タブで**定期的キャプチャ**を有効にします。
-   **ゆっくり表示されるテキスト**: メインのOCR問題と同様に、テキストがフェードインする場合、オーバーレイは早すぎるタイミングでスキャンする可能性があります。
    -   **解決策**: `オーバーレイ`設定の**スキャン遅延**または**イベントごとの追加ローカルスキャン**オプションを使用して、最終スキャンの前にテキストが完全に表示される時間を確保します。
-   **フォーカスの問題**: 排他的フルスクリーンの一部のゲームでは、マウスが「トラップ」され、オーバーレイと対話できなくなることがあります。
    -   **解決策**: **手動モード（ホットキー）**を有効にします。これにより、キーを押したままにしてオーバーレイを有効にし、ルックアップを行い、キーを離してゲームにフォーカスを戻すことができます。

## 統合（Yomitan、Migaku、Anki）

### Ankiカードに文の一部しか表示されない

これはYomitanの問題であり、GSMの問題ではありません。Yomitanは句読点に基づいて文を分割します。

-   **解決策**: Yomitanの設定の`解析`で、**文の終端文字**を**改行のみ**に変更します。この設定でテキストフッカーページ専用のYomitanプロファイルを別途作成することを強くお勧めします。

### Migaku拡張機能がセンテンスマイニングを妨害している

Migakuブラウザ拡張機能は、テキストフッカーページのHTMLを大幅に変更するため、Yomitanが文を解析する方法に干渉する可能性があります。

-   **解決策**: Yomitanの設定の`スキャン`で、**レイアウト認識スキャンを有効にする**オプションを**オフ**にします。これにより、通常は問題が解決します。

### OpusオーディオファイルがAnki for iOSで再生されない

Anki on iOSはOpusオーディオ形式をサポートしていません。

-   **解決策**: GSMの`設定 -> 音声`で、**音声出力拡張子**を`mp3`に変更します。既存のカードについては、FFmpegスクリプトを使用して`.opus`ファイルを`.mp3`にバッチ変換する必要があるかもしれません。
